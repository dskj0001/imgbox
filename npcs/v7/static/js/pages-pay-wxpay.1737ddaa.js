(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-pay-wxpay"],{"07ad":function(t,e,a){var n=a("be0b");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("0785863a",n,!0,{sourceMap:!1,shadowMode:!1})},"25a5":function(t,e,a){"use strict";var n=a("07ad"),i=a.n(n);i.a},be0b:function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */.pay[data-v-2d2f9de3]{width:100%;height:100vh;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;font-size:16px;font-weight:700;text-align:center}',""]),t.exports=e},cad1:function(t,e,a){"use strict";a.r(e);var n=a("e7cc"),i=a("e751");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("25a5");var r,d=a("f0c5"),c=Object(d["a"])(i["default"],n["b"],n["c"],!1,null,"2d2f9de3",null,!1,n["a"],r);e["default"]=c.exports},e751:function(t,e,a){"use strict";a.r(e);var n=a("f1a4"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},e7cc:function(t,e,a){"use strict";var n,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"pay"},[t._v("正在跳转中,请稍后.....")])},o=[];a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}))},f1a4:function(t,e,a){"use strict";(function(t){var n=a("ee27");a("c975"),a("4d63"),a("ac1f"),a("25f0"),a("466d"),a("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var i=n(a("c964")),o=n(a("fbc4")),r={data:function(){return{code:"",videoId:"",orderId:"",category:1,params:""}},onLoad:function(){},methods:{hideMenu:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$api.post("/api/agency/config",{}).then((function(t){var e=t.data.errorCode,a=(t.data.msg,t.data.data);0==e&&(o.default.config({debug:!1,appId:a.appId,timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:["hideMenuItems","hideOptionMenu"]}),o.default.ready((function(){o.default.hideOptionMenu()})))})).catch((function(e){t.log(e)}));case 1:case"end":return a.stop()}}),a)})))()},getUrlParam:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),a=window.location.href.split("#")[0],n=a.split("?")[1];if(n){var i=n.substr(0).match(e);return null!==i?unescape(i[2]):null}return null},codeUrl:function(){var e=this,a=window.location.href.substring(0,window.location.href.indexOf("pages"));a=a.split("/");var n=a[3],i=this;this.$api.post("/v1/api/pay/wechat_domain",{}).then((function(a){var o=a.data.code,r=a.data.data;if(0==o){var d="http://"+r+"/"+n+"/pages/pay/wxpay?videoId="+i.videoId,c=window.location.protocol+"//"+window.location.host+"/"+n+"/";i.$api.post("/v1/api/pay/native",{redirect_uri:d,category:e.category,domain:c,agentId:uni.getStorageSync("agentId")}).then((function(t){var e=t.data.code,a=t.data.data;0==e&&(window.location.href=a)})).catch((function(e){t.log(e)}))}})).catch((function(e){uni.hideLoading(),t.log(e)}))},openidUrl:function(){var e=this;this.$api.post("/v1/api/pay/openid",{code:this.code}).then((function(t){var a=t.data.code,n=t.data.data;0==a&&e.payment(n)})).catch((function(e){uni.hideLoading(),t.log(e)}))},payment:function(e){var a=this,n=this;t.log(e);var i=this.params.split("-");t.log(this.params),t.log(i),this.$api.post("/v1/api/pay/wechatPay",{videoId:this.videoId,agentId:i[0],userId:uni.getStorageSync("userid"),category:i[1],domain:e}).then((function(e){var i=e.data.code,o=(e.data.msg,e.data.data);0==i&&(t.log(o),a.orderId=o.out_trade_no,"undefined"===typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",(function(){n.onBridgeReady(o,n)}),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",(function(){n.onBridgeReady(o,n)})),document.attachEvent("onWeixinJSBridgeReady",(function(){n.onBridgeReady(o,n)}))):n.onBridgeReady(o,n))})).catch((function(t){}))},onBridgeReady:function(t,e){document.title="正在唤起,请稍后...";var a=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,signType:t.signType,paySign:t.paySign},(function(n){if("get_brand_wcpay_request:ok"===n.err_msg){var i=a.params.split("-");window.location.href=i[2]+"pages/detail/detail?orderId="+t.orderid}else if("get_brand_wcpay_request:cancel"==n.err_msg){i=e.params.split("-");window.location.href=i[2]+"pages/index/index"}else if("get_brand_wcpay_request:fail"==n.err_msg){i=e.params.split("-");window.location.href=i[2]+"pages/index/index"}}))}},created:function(){var t=this.getUrlParam("code"),e=this.getUrlParam("videoId"),a=this.getUrlParam("category"),n=this.getUrlParam("state");null==t||""==t?(this.videoId=e,this.category=a,this.codeUrl()):(this.code=t,this.videoId=e,this.params=n,this.openidUrl())}};e.default=r}).call(this,a("5a52")["default"])}}]);